{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Quiz 160905\"\nauthor: \"coop711\"\ndate: \"`r Sys.Date()`\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n# install.packages(\"pander\", repos = \"https://cran.rstudio.com\")\n# install.packages(\"xlsx\", repos = \"https://cran.rstudio.com\")\nlibrary(xlsx)\nlibrary(pander)\nlibrary(knitr)\npanderOptions('table.split.table', Inf)\npanderOptions('table.alignment.rownames', 'left')\npanderOptions('table.alignment.default', 'right')\noptions(width=180)\n```\n\n```{r, data, echo = FALSE, results = 'hide'}\nquiz0905 <- read.xlsx(\"../data/quiz0905_test.xlsx\", 1, startRow = 2, endRow = 101, colIndex = c(3:7, 9:14), colClasses=c(rep(\"character\", 11)), stringsAsFactors=FALSE)\nstr(quiz0905)\nnames(quiz0905) <- c(\"dept\", \"id\", \"name\", \"year\", \"e.mail\", \"cell.no\", \"Q1\", \"Q2\", \"Q3\", \"Q4\", \"group\")\nquiz0905$dept <- factor(quiz0905$dept)\nquiz0905$year <- factor(quiz0905$year)\nquiz0905$group <- factor(quiz0905$group, levels = c(\"Red\", \"Black\"))\nquiz0905$Q1 <- factor(quiz0905$Q1, levels = c(\"가\", \"나\", \"다\", \"라\", \"마\"), labels = c(\"9:1\", \"8:2\", \"7:3\", \"6:4\", \"5:5\"))\nquiz0905$Q2 <- factor(quiz0905$Q2, levels = c(\"가\", \"나\", \"다\", \"라\", \"마\"), labels = c(\"10%\", \"30%\", \"50%\", \"70%\", \"90%\"))\nquiz0905$Q3 <- factor(quiz0905$Q3, levels = c(\"가\", \"나\", \"다\", \"라\", \"마\"), labels = c(\"7:3\", \"6:4\", \"5:5\", \"4:6\", \"3:7\"))\nquiz0905$Q4 <- factor(quiz0905$Q4, levels = c(\"가\", \"나\", \"다\"), labels = c(\"찬성 입장\", \"반대 입장\", \"모름/무응답\"))\nquiz0905$Q4.2 <- quiz0905$Q4\nlevels(quiz0905$Q4.2)\nlevels(quiz0905$Q4.2) <- c(\"찬성\", \"반대\", \"모름/무응답\")\nstr(quiz0905)\n```\n\n```{r, summary, echo = FALSE, results = 'hide'}\npander(summary(quiz0905))\n```\n\n### 퀴즈 응답 비교\n\n#### 우리나라 국세와 지방세 배분비율\n\n##### 국세와 지방세\n\n```{r, National and Local tax, echo = FALSE}\npander(addmargins(table(quiz0905$group, quiz0905$Q1, exclude = NULL), margin=1))\n```\n\n##### 국세와 지방세(%)\n\n```{r, National and Local tax in percentage, echo = FALSE}\npander(round(prop.table(addmargins(table(quiz0905$group, quiz0905$Q1, exclude = NULL), margin=1), margin=1)[4,]*100, digits=1))\n```\n\n#### 공법도입에 대한 대신들의 찬성율\n\n##### 공법도입과 대신들(집계표)\n\n```{r, tax law and cabinets, echo = FALSE}\npander(addmargins(table(quiz0905$group, quiz0905$Q2, exclude = NULL), margin=1))\n```\n\n##### 공법도입과 대신들(%)\n\n```{r, tax law and cabinets in percentage, echo = FALSE}\npander(round(prop.table(addmargins(table(quiz0905$group, quiz0905$Q2, exclude = NULL), margin=1), margin=1)[4,]*100, digits=1), caption=\"공법도입과 대신들\")\n```\n\n#### 공법도입과 품관촌민들의 찬반\n\n##### 품관촌민들의 찬반(집계표)\n\n```{r, tax law and laymen, echo = FALSE}\npander(addmargins(table(quiz0905$group, quiz0905$Q3, exclude = NULL), margin=1))\n```\n\n##### 품관촌민들의 찬반(%)\n\n```{r, tax law and laymen in percentage, echo = FALSE}\npander(round(prop.table(addmargins(table(quiz0905$group, quiz0905$Q3, exclude = NULL), margin=1), margin=1)[4,]*100, digits=1), caption=\"품관촌민들의 찬반\")\n```\n\n### 테러방지법 찬반\n\n#### 테러방지법 찬반\n\n##### 집계표. 찬반 어느 쪽에 부연설명을 하였는가(Red는 찬성 쪽에 부연설명, Black은 반대 쪽에 부연설명)에 따라 찬반에 영향. \n\n```{r, anti-terror law, echo = FALSE}\npander(table(quiz0905$group, quiz0905$Q4, exclude = NULL), caption=\"테러방지법\")\n# pander(table(quiz0905$group, quiz0905$Q4.2, exclude = NULL), caption=\"테러방지법\")\n```\n\n##### % 비교.  \n\n```{r, anti-terror law in percentage, echo = FALSE}\nthaad.tbl <- table(quiz0905$group, quiz0905$Q4)\n# thaad.tbl.2 <- table(quiz0905$group, quiz0905$Q4.2)\n# pander(round(prop.table(thaad.tbl, margin = 1)*100, digits = 1), caption=\"테러방지법(단위, %)\")\npander(round(prop.table(thaad.tbl, margin = 1)*100, digits = 1))\n# pander(round(prop.table(thaad.tbl.2, margin = 1)*100, digits = 1), caption = \"테러방지법(단위, %)\")\n```\n\n```{r, save, echo = FALSE}\n#save.image(\"../R/quiz0905.rda\")\n```",
    "created" : 1472978501887.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "125824107",
    "id" : "D255A74A",
    "lastKnownWriteTime" : 1472979464,
    "last_content_update" : 1472979464271,
    "path" : "~/Google 드라이브/Works/Class/Statistics/R.WD/Class_data/class201602/R/quiz0905_Report.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}